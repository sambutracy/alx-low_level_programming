This includes more functions and nested loops
